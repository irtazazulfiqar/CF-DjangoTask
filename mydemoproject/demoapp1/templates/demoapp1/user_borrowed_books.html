{% extends "base_user.html" %}

{% block title %}User Borrowed Books{% endblock %}

{% block content %}
<section>
    <h2>Borrowed Books</h2>
    <form method="get">
        <label for="author_name">Author Name:</label>
        <select name="author_name" id="author_name">
            <option value="">All</option>
            {% for author in authors %}
                <option value="{{ author }}" {% if request.GET.author_name == author %}selected{% endif %}>
                    {{ author }}
                </option>
            {% endfor %}
        </select>

        <label for="book_name">Book Name:</label>
        <select name="book_name" id="book_name">
            <option value="">All</option>
            {% for book_name in book_names %}
                <option value="{{ book_name }}" {% if request.GET.book_name == book_name %}selected{% endif %}>
                    {{ book_name }}
                </option>
            {% endfor %}
        </select>

        <label for="status">Status:</label>
        <select name="status" id="status">
            <option value="">All</option>
            <option value="not_returned" {% if request.GET.status == 'not_returned' %}selected{% endif %}>Not Returned</option>
            <option value="returned" {% if request.GET.status == 'returned' %}selected{% endif %}>Returned</option>
            <option value="overdue" {% if request.GET.status == 'overdue' %}selected{% endif %}>Overdue</option>
        </select>

        <button type="submit">Filter</button>
    </form>

    <!-- Borrowed Books Table -->
    <table>
        <thead>
            <tr>
                <th>Book Name</th>
                <th>Author Name</th>
                <th>Borrow Date</th>
                <th>Return Date</th>
                <th>Due Date</th>
            </tr>
        </thead>
        <tbody>
            {% for borrowed_book in borrowed_books %}
            <tr>
                <td>{{ borrowed_book.book.book_name }}</td>
                <td>{{ borrowed_book.book.author_name }}</td>
                <td>{{ borrowed_book.borrow_dttm }}</td>
                <td>{{ borrowed_book.return_dttm }}</td>
                <td>{{ borrowed_book.due_date }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">No borrowed books found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endblock %}
